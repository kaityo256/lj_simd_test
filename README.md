# SIMD化練習用コード

## 目的

カットオフ無しのLennard-Jonesポテンシャルの力の計算をSIMD化し、結果は一致させつつ実行速度を向上させる。

## 実行方法

ファイルがあるディレクトリで`make`を実行する。

```sh
make
```

すると、`a.out`が作成されるので、実行する。

```sh
$ ./a.out
N=4000, simple   4313 [ms]
N=4000, simd     4329 [ms]
Check OK
```

simpleは関数`calc_force_simple`の実行時間を計測したもの。
simdは関数`calc_force_simd`の実行時間を計測したもの。

両者の実行結果が一致すれば「Check OK」、不一致なら「Check Failed」と表示される。

関数`calc_force_simd`は、一部だけSIMD命令が使われている。この関数を「Check OK」の状態を保ちながらSIMD化していき、最終的に二倍以上の実行速度向上を目指す。ディレクトリ`answer`の中に答えとなるファイルがあるが、なるべく見ないでがんばって欲しい。

答えは見ずに、自分の環境でどれだけ実行速度が向上したか確認したければ、`answer`の中でmakeし、`a.out`を実行する。

```sh
cd answer
make
./a.out
```

## ヒント

* まずループを4倍展開する (端数処理に気を付ける)
* 4倍展開したものを少しずつSIMD化していく (毎回結果が一致することを確認する)
* 途中でレジスタの「転置」が必要になる。

## ライセンス

MIT